<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <title>Dashboard | ControlTechStock</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="styles.css" rel="stylesheet">
  <script defer src="script.js"></script>
</head>
<body>
  <div class="app">
    <aside class="sidebar">
      <div class="brand">
        <div class="logo">CTS</div>
        <div>
          <div>ControlTechStock</div>
          <small>Panel principal</small>
        </div>
      </div>

      <nav class="nav">
        <a class="active" href="dashboard.html">Dashboard</a>
        <a href="inventario.html">Inventario</a>
        <a href="reportes.html">Proveedores</a>
        <a href="usuarios.html">Usuarios</a>
        <a href="configuracion.html">Configuración</a>
      </nav>
    </aside>

    <main class="content">
      <div class="header">
        <div class="hstack">
          <span class="badge">Versión UI – prototipo</span>
          <span class="badge">Semáforo activo</span>
        </div>
        <a class="btn secondary" href="login.html">Cerrar sesión</a>
      </div>

      <div class="grid kpis">
        <div class="card">
          <h3>Stock total (unidades)</h3>
          <div class="big" id="kpiStockTotal">—</div>
          <div class="subtle">Actualizado desde SQL</div>
        </div>
        <div class="card">
          <h3>Productos con stock bajo</h3>
          <div class="big" id="kpiCriticos">—</div>
          <div class="kpi-chip warn">Atención</div>
        </div>
        <div class="card">
          <h3>Valor estimado de stock</h3>
          <div class="big" id="kpiValorInventario">—</div>
          <div class="subtle">Precio promedio ponderado</div>
        </div>
        <div class="card">
          <h3>Movimientos hoy (ref.)</h3>
          <div class="big" id="kpiMovRef">—</div>
          <div class="trend">auto-cálculo simple</div>
        </div>
      </div>

      <div class="card">
        <div class="section-title">Semaforización de stock</div>
        <div class="legend">
          <span><span class="dot bad"></span> Rojo: sin stock / crítico (≤2)</span>
          <span><span class="dot warn"></span> Amarillo: bajo mínimo (3–9)</span>
          <span><span class="dot ok"></span> Verde: suficiente (≥10)</span>
        </div>
      </div>

      <!-- Nivel 1: Categorías con productos críticos -->
      <div class="card">
        <div class="section-title">Categorías con productos con stock bajo (clic para ver detalle)</div>
        <div id="categoriasCriticas" class="hstack" style="gap:10px; flex-wrap:wrap"></div>
      </div>

      <!-- Nivel 2: Productos de la categoría seleccionada -->
      <div id="productosDeCategoria" style="margin-top:14px"></div>

      <!-- Nuevas entidades resumen -->
      <div class="grid kpis" style="margin-top:14px;">
        <div class="card" id="cardProveedores">
          <h3>Proveedores</h3>
          <div id="proveedoresList">Cargando proveedores…</div>
          <div class="subtle">Haz clic en un proveedor para filtrar Inventario</div>
        </div>

        <div class="card" id="cardUsuariosRol">
          <h3>Usuarios por rol</h3>
          <div id="usuariosPorRol">Cargando usuarios…</div>
          <div class="subtle">Control de accesos: distribución por rol</div>
        </div>

        <div class="card" id="cardPrecios">
          <h3>Últimos cambios de precio</h3>
          <div id="preciosRecientes">Cargando historial de precios…</div>
          <div class="subtle">Últimos 20 cambios</div>
        </div>
      </div>

    </main>
  </div>
</body>
</html>
